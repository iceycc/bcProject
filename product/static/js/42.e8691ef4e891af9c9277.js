webpackJsonp([42],{BS7J:function(t,e){},iX7c:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("EOwk"),i=a("b1t1"),o=a("MmTA"),n=a("0jG4"),r=a("msXN"),c=a("JIj5"),l={data:function(){return{proDetail:{MIN_AMOUNT:"200",INCRE_AMOUNT:"10"},moneyNum:null,payNum:"",agree:!0,imgSrc:s.g,INCRE_AMOUNT:"",show:!1}},components:{PassWordZhengzhou:i.a},computed:{placeHolder:function(){return this.proDetail.MIN_AMOUNT+"元起购"},canClick:function(){return!(!this.moneyNum||!this.agree)},ifCheckMoneyEmpty:function(){return!this.moneyNum}},mixins:[r.a.HandleMixin,r.a.StoreMixin],created:function(){this.getInfo();var t=this.getComState.goBuy;this.proDetail.MIN_AMOUNT=t.MIN_AMOUNT,this.proDetail.INCRE_AMOUNT=t.INCRE_AMOUNT||"0.01",this.proDetail.logo=t.logo||t.LOGO_URL,this.proDetail.id=t.id,this.proDetail.ORG_NAME=t.ORG_NAME,this.proDetail.PRD_NAME=t.PRD_NAME,this.proDetail.REMAIN_AMT=t.REMAIN_AMT||"10000",this.proDetail.IDENTICAL_PRD_TAG=t.IDENTICAL_PRD_TAG,console.log(t)},methods:{clearNumHandle:function(){this.moneyNum=""},getInfo:function(){var t=this;n.a.bank.apiQryAsset({},function(e){console.log(e),t.payNum=e.ACC_REST})},goReChang:function(){this.setComState({type:"OriginPage",value:this.$route.fullPath}),this.$router.push({name:s.e.Recharge})},getAgreement:function(t){this.agree=!0,this.$router.push({name:s.e.DocsPage,query:{type:t}})},checkMoneyNum:function(t){return t<parseInt(this.proDetail.MIN_AMOUNT)&&(o.a.$emit(s.a.showToast,"投资金额小于起投金额，请调整投资金额"),!0)},goBuy:function(){var t=this;this.agree?this.moneyNum?"number"!=typeof(this.moneyNum-0)||isNaN(this.moneyNum-0)?o.a.$emit(s.a.showToast,"请填写正确的金额"):this.moneyNum-0>this.payNum?o.a.$emit(s.a.showToast,"余额不足，请充值"):this.checkMoneyNum(this.moneyNum)||(this.moneyNum-0>this.REMAIN_AMT?o.a.$emit(s.a.showToast,"可投额度不足"):(this.Londing.open({spinnerType:"triple-bounce"}),setTimeout(function(){t.Londing.close()},500),this.buyHandle())):o.a.$emit(s.a.showToast,"请输入购买金额"):o.a.$emit(s.a.showToast,"请同意相关协议")},buyHandle:function(){var t=this;this.Londing.open(),setTimeout(function(){t.show=!0,t.Londing.close()},500)},doPay:function(){var t=this,e=$("#payPasscc").getKBD(),a=$("#payPasscc").getLenKBD(),i=$("#payPasscc").getBDCode();console.log(e);var o={TYPE:"API_BUY",PRD_ID:this.proDetail.id+"",APPLY_AMOUNT:c.a.fromatMoney(this.moneyNum),BANK_PAY_PW:e+"",PREFIX:i,FUN_TYPE:"1",ORDER_TYPE:"1"};c.a.Check.payPassLen(a,!0)||(this.show=!1,n.a.buy.apiBuy(o,function(e){t.polling(e)},function(e){t.Londing.close(),t.$router.push({name:s.e.BuyFailed,query:{err:e}})}))},polling:function(t){var e=this,a={BIZ_TYPE:"6",BESHARP_SEQ:t.BESHARP_BUY_SEQ};this.Londing.open({text:"正在购买中"});var i=1,r=setInterval(function(){i++,n.a.common.apiQueryBizStatus(a,function(t){if("1"==t.RES_CODE||5==i)e.Londing.close(),clearInterval(r),o.a.$emit(s.a.showToast,t.RES_MSG),e.$router.push({name:s.e.BuyFailed,query:{err:t.RES_MSG}});else{if("0"==t.RES_CODE)return clearInterval(r),o.a.$emit(s.a.showToast,t.RES_MSG),e.Londing.close(),e.setComState({type:"buyData",value:t}),void e.$router.push({name:s.e.BuySuccess});if(i>5)return o.a.$emit(s.a.showToast,t.RES_MSG),void e.$router.push({name:s.e.BuyFailed,query:{err:t.RES_MSG}})}})},2e3)}}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app",attrs:{id:"app"}},[s("app-bar",{attrs:{title:"购买"}}),t._v(" "),s("div",{staticClass:"buytitle"},[s("div",{staticClass:"buytitleleft"},[s("div",{staticClass:"buytitleleftimg"},[s("img",{staticStyle:{width:"100%"},attrs:{src:t.imgSrc+t.proDetail.logo,alt:""}})]),t._v(" "),s("div",{staticClass:"buytitleleftcontent"},[s("p",[t._v(t._s(t.proDetail.ORG_NAME))]),t._v(" "),s("p",{staticStyle:{color:"#666"}},[t._v(t._s(t.proDetail.PRD_NAME))])])]),t._v(" "),s("div",{staticClass:"buytitleright"},[s("p",[t._v("起购金额"+t._s(t.proDetail.MIN_AMOUNT)+"元")]),t._v(" "),s("p",[t._v("最小递增0.00元")])])]),t._v(" "),s("div",{staticClass:"buysuccessdetails"},[s("div",{staticClass:"buysuccessdetailleft"},[t._v("可用金额 "),s("strong",[t._v(t._s(t._f("formatNum")(t.payNum))+"元")])]),t._v(" "),s("div",{staticClass:"buysuccessdetailright",on:{click:t.goReChang}},[t._v("充值")])]),t._v(" "),s("div",{staticClass:"buydetails"},[s("p",{staticStyle:{"margin-top":"0.3rem"}},[t._v("购买金额")]),t._v(" "),s("span",{staticClass:"buydetailsmoney"},[t._v("￥")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.moneyNum,expression:"moneyNum"}],attrs:{type:"number",placeholder:t.placeHolder},domProps:{value:t.moneyNum},on:{input:function(e){e.target.composing||(t.moneyNum=e.target.value)}}}),t._v(" "),s("img",{directives:[{name:"show",rawName:"v-show",value:!t.ifCheckMoneyEmpty,expression:"!ifCheckMoneyEmpty"}],staticClass:"close-icon",attrs:{src:a("rfOz"),alt:""},on:{click:t.clearNumHandle}})]),t._v(" "),s("button",{class:{tijiao:!0,active:t.canClick},attrs:{disabled:!t.canClick},on:{click:t.goBuy}},[t._v("购买")]),t._v(" "),s("p",{class:{bang:!0,no:0==t.agree},on:{click:function(e){t.agree=!t.agree}}},[t._v("我已阅读并同意\n    "),s("a",{staticStyle:{color:"#0096FE"},attrs:{href:"javascript:;"},on:{click:function(e){e.stopPropagation(),t.getAgreement("buy")}}},[t._v("《日添利-博时基金 ”产品业务服务协议》")])]),t._v(" "),t.show?s("section",{staticClass:"bgbox"},[s("section",{staticClass:"passbox"},[t._m(0),t._v(" "),s("section",{staticClass:"field_row_wrap"},[s("p",{staticClass:"field_row_key"},[t._v("\n          交易密码\n        ")]),t._v(" "),s("div",{staticClass:"field_row_value"},[s("pass-word-zhengzhou",{attrs:{BankCardPass:"payPasscc"}})],1),t._v(" "),s("p",{staticClass:"info"},[t._v("密码由数字组成，必须为6位")])]),t._v(" "),s("div",{staticClass:"btn"},[s("mt-button",{attrs:{type:"primary"},on:{click:function(e){t.show=!t.show}}},[t._v("取消")]),t._v(" "),s("mt-button",{attrs:{type:"primary"},on:{click:t.doPay}},[t._v("提交")])],1)])]):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"title"},[e("img",{attrs:{src:a("j732"),alt:""}}),this._v("\n        由郑州银行提供技术保障")])}]};var m=a("VU/8")(l,u,!1,function(t){a("BS7J")},"data-v-8bf90fae",null);e.default=m.exports}});
//# sourceMappingURL=42.e8691ef4e891af9c9277.js.map