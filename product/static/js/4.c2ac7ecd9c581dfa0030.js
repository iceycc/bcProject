webpackJsonp([4],{"8a/n":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("ehhp");var i=a("NVmV"),s=a.n(i),n=a("0jG4"),o=a("EOwk"),r=a("MmTA"),d=a("JIj5"),l=(a("msXN"),{mixins:[""],data:function(){return{searchCondition:{pageNo:"1",pageSize:"10"},pageList:[],allLoaded:!1,scrollMode:"auto",pageList3:[],tabsParam:["1个月","2个月","3个月"," "],nowIndex:0,startDate:"",endDate:"",divSizeObj:{small:{},large:{}}}},created:function(){},components:{"v-loadmore":s.a},mounted:function(){this.loadPageList(),this.setEleSize()},methods:{setEleSize:function(){console.log(this.nowIndex);var t=d.a.getWinSize().winHeight,e=d.a.getDivSize(".wrap-top").height,a=d.a.getDivSize(".tabs").height,i=3==this.nowIndex?a:0,s=t-e-i;console.log(e,s,i),document.querySelector(".t-tab").style.top=e+"px",document.querySelector(".main-body").style.height=s+"px"},loadTop:function(){this.loadPageList(),this.$refs.loadmore.onTopLoaded()},loadBottom:function(){this.more(),this.$refs.loadmore.onBottomLoaded()},loadPageList:function(){this.searchCondition.pageNo="1",this.allLoaded=!1;var t=this.nowIndex;this.setEleSize(),3==this.nowIndex&&(t=0),this.endDate=this.getLastMonthYestdy(0),this.startDate=this.getLastMonthYestdy(t+1),this.apiQryTradeHis(this.startDate,this.endDate)},more:function(){var t=this;this.searchCondition.pageNo=""+(parseInt(this.searchCondition.pageNo)+1);var e={currentPage:this.searchCondition.pageNo,START_DATE:this.startDate,END_DATE:this.endDate};n.a.financial.apiQryTradeHis(e,function(e){t.pageList=t.pageList.concat(e.PAGE.retList),e.PAGE.retList.length<t.searchCondition.pageSize&&(t.allLoaded=!0,r.a.$emit(o.a.showToast,"数据全部加载完成"))})},apiQryTradeHis:function(t,e){var a=this,i={currentPage:"1",START_DATE:t,END_DATE:e};n.a.financial.apiQryTradeHis(i,function(t){a.pageList=t.PAGE.retList,a.pageList.length<a.searchCondition.pageSize&&(a.allLoaded=!0),a.pageList.length<=0&&r.a.$emit(o.a.showToast,"暂无数据"),a.$nextTick(function(){this.scrollMode="touch"})})},toggleTabs:function(t){this.nowIndex=t,this.pageList=[],this.loadPageList()},setDate:function(){var t=this;this.$picker.show({type:"datePicker",endTime:this.getLastYearYestdy(0),startTime:this.getLastYearYestdy(2),onOk:function(e){t.endDate=t.fomateDate(e)}})},setDate2:function(){var t=this;this.$picker.show({type:"datePicker",date:this.startDate,endTime:this.getLastYearYestdy(0),startTime:this.getLastYearYestdy(2),onOk:function(e){t.startDate=t.fomateDate(e)}})},fomateDate:function(t){return t.split("-").map(function(t){return t.length>1?t:0+t}).join("-")},getLastMonthYestdy:function(t){var e=new Date,a=new Array([0],[31],[28],[31],[30],[31],[30],[31],[31],[30],[31],[30],[31]),i=e.getFullYear(),s=e.getDate(),n=e.getMonth()+1;return i%4==0&&i%100!=0&&(a[2]=29),n-t==0?(i-=1,n=12):n-=t,s=Math.min(s,a[n]),n<10&&(n="0"+n),s<10&&(s="0"+s),i+"-"+n+"-"+s},checkTime:function(t,e){var a=t,i=e;if(!i)return!0;var s=new Date(a).getTime(),n=new Date(i).getTime();if(""==a)return r.a.$emit(o.a.showToast,"开始日期不能为空"),!1;if(""==i)return r.a.$emit(o.a.showToast,"结束日期不能为空"),!1;if(s>n)return r.a.$emit(o.a.showToast,"开始日期不能大于结束日期"),!1;var d=a.split("-"),l=i.split("-");d[1]=parseInt(d[1]),d[2]=parseInt(d[2]),l[1]=parseInt(l[1]),l[2]=parseInt(l[2]);var c=!0;return d[0]==l[0]?l[1]-d[1]>3?c=!1:l[1]-d[1]==3&&l[2]>d[2]&&(c=!1):l[0]-d[0]>1?c=!1:l[0]-d[0]==1&&(d[1]<10?c=!1:d[1]+3-l[1]<12?c=!1:d[1]+3-l[1]==12&&l[2]>d[2]&&(c=!1)),!!c||(r.a.$emit(o.a.showToast,"查询日期范围太大，最大可查三个月的记录"),!1)},getLastYearYestdy:function(t){var e=new Date,a=e.getFullYear()-t,i=e.getDate(),s=e.getMonth()+1;return s<10&&(s="0"+s),i<10&&(i="0"+i),a+"-"+s+"-"+i},query:function(){this.checkTime(this.startDate,this.endDate),this.apiQryTradeHis(this.startDate,this.endDate)}}}),c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrap"},[a("div",{staticClass:"wrap-top"},[a("app-bar",{attrs:{title:"交易明细"}}),t._v(" "),a("ul",{staticClass:"tabs"},t._l(t.tabsParam,function(e,i){return a("li",{staticClass:"li-tab",class:{active:i==t.nowIndex},on:{click:function(e){t.toggleTabs(i)}}},[t._v(t._s(e)+"\n      ")])}))],1),t._v(" "),a("div",{staticClass:"t-tab"},[a("div",{staticClass:"divTab"},[a("div",{directives:[{name:"show",rawName:"v-show",value:3===t.nowIndex,expression:"nowIndex===3"}],staticClass:"t-date"},[a("ul",[a("li",{on:{click:t.setDate2}},[t._v("\n            "+t._s(t.startDate)+"\n            "),a("span")]),t._v(" "),a("li",{on:{click:t.setDate}},[t._v("\n            "+t._s(t.endDate)+"\n            "),a("span")])]),t._v(" "),a("div",{staticClass:"t-query",on:{click:t.query}},[t._v("查询")])]),t._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:3===t.nowIndex,expression:"nowIndex===3"}],staticClass:"t-text"},[t._v("根据银行要求，只能查询最近两年记录，每次查询最大范围三个月")]),t._v(" "),a("div",{staticClass:"t-content main-body",style:{"-webkit-overflow-scrolling":t.scrollMode}},[a("v-loadmore",{ref:"loadmore",attrs:{"top-method":t.loadTop,"bottom-method":t.loadBottom,"bottom-all-loaded":t.allLoaded,"auto-fill":!1}},[a("div",[a("ul",t._l(t.pageList,function(e,i){return a("li",{key:i},[a("h5",[t._v(t._s(e.TRANS_TYPE_NAME))]),t._v(" "),a("p",[a("span",[t._v(t._s(t._f("timerFormat")(e.TRANS_TIEM)))]),t._v(" "),a("em",[t._v("¥"+t._s(t._f("formatNum")(e.TRANS_AMT)))])])])}))])])],1)])])])},staticRenderFns:[]};var h=a("VU/8")(l,c,!1,function(t){a("pTEb"),a("xwsU")},"data-v-9ad3f172",null);e.default=h.exports},pTEb:function(t,e){},xwsU:function(t,e){}});
//# sourceMappingURL=4.c2ac7ecd9c581dfa0030.js.map