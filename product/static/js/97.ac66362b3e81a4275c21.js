webpackJsonp([97],{"2FyH":function(t,a){},Xrww:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("EOwk"),n=e("MmTA"),i=e("xEK7"),o=e("0jG4"),c=e("JIj5"),l=void 0,_={mixins:[e("BhYf").a],data:function(){return{telDisabled:!1,ZhengZhouPass:!1,ACC_FLAG:"0",pwd:"",pwdLen:"",pwCode:""}},created:function(){console.log("ZhengZhou")},filters:{CARD_NO_Fliter:function(t){return t?t.substr(t.length-4):t}},methods:{timeDown:function(){var t=this,a=60;this.disable=!0,l=setInterval(function(){if(0==a)return t.codeText="重新发送",t.disable=!1,void clearInterval(l);a--,t.codeText=a+"s"},1e3)},cancel:function(){$("#PWDKBD").remove(),this.ZhengZhouPass=!1},subumit:function(){$("#PWDKBD").remove(),this.pwd=$("#bank-passCCCC").getKBD(),this.pwdLen=$("#bank-passCCCC").getLenKBD(),this.pwCode=$("#bank-passCCCC").getBDCode(),console.log(this.pwd),console.log(this.pwdLen),console.log(this.pwCode),c.a.Check.payPassLen(this.pwdLen,!0)||(this.ZhengZhouPass=!1,this.doApiOpenging2())},checkBankType:function(){var t=this;o.a.common.apiUserAccountProperties({TYPE:"API_USER_ACCOUNT_PROPERTIES",BIND_AC_NO:this.data.CARD_NO+""},function(a){t.ACC_FLAG=a.ACC_FLAG})},checkID:function(){},clickMsgCodeHandle:function(){var t=this.tel;t+="",console.log(t),c.a.Check.tel(t,!0)||(this.timeDown(),this.getMsgCode(t))},getMsgCode:function(t){var a=this,e={TYPE:"API_SEND_PHONE_CODE",PHONE_NUM:t,BIZ_TYPE:"11",ACCT_NO:this.data.CARD_NO};o.a.common.apiSendPhoneCode(e,function(e){n.a.$emit(s.a.showSendMsg,t),a.data.MESSAGE_TOKEN=e.MESSAGE_TOKEN},function(t){a.codeText="重新发送",a.disable=!1;try{clearInterval(l)}catch(t){}console.log(t)})},doOpengingSecond:function(){0==this.ACC_FLAG?this.doApiOpenging2():($("#PWDKBD").remove(),this.ZhengZhouPass=!0)},doApiOpenging2:function(){var t=this;if(this.data.PRE_PHONE_NUM=this.tel,console.log(this.data.PRE_PHONE_NUM),"请选择银行"!=this.bankText)if(""!=this.data.CARD_NO){if(!this.checkBankNo(this.data.CARD_NO))if(""!=this.data.PRE_PHONE_NUM)if(""!=this.data.PHONE_CODE){var a={TYPE:"API_REGISTER_BAND_CARD",BIND_AC_NO:this.data.CARD_NO,BANK_NAME:this.bankText,ACC_FLAG:this.ACC_FLAG,PREFIX:this.pwCode||null,PASSWD:this.pwd||null,COMMON_USER_ID:this.callbackInfos.COMMON_USER_ID,SND_MSG_TYPE:"11",SND_MSG:this.data.PHONE_CODE,HAS_BAND:this.callbackInfos.hasCardList&&this.callbackInfos.hasCardList.length>0?"1":"0",CARD_FRONT_URL:this.callbackInfos.CARD_FRONT_URL.replace(/\+/g,"%2B"),CARD_BACK_URL:this.callbackInfos.CARD_BACK_URL.replace(/\+/g,"%2B"),USER_NAME:this.callbackInfos.USER_NAME,USER_DUTY:this.callbackInfos.USER_DUTY,PHONE_NUM:this.tel,BESHARP_REGISTER_VALI_USER_SEQ:this.callbackInfos.BESHARP_REGISTER_VALI_USER_SEQ};console.log("params"),console.log(a),o.a.open.apiRegisterBandCard(a,!0,!0,function(a){clearInterval(l),t.Londing.close(),t.errMsg=a.MSG,setTimeout(function(){t.errMsg=""},2e3),o.a.watchApi({FUNCTION_ID:"ptb0A004",REMARK_DATA:"异业合作-开户-绑定银行卡"}),0==a.CODE&&(t.setComState({type:"openingData",value:a}),t.$router.push({name:s.e.Opening3}))},function(a){o.a.watchApi({FUNCTION_ID:"ptb0A004",REMARK_DATA:"异业合作-开户-绑定银行卡"}),t.codeText="重新发送",t.disable=!1,t.errMsg=a,setTimeout(function(){t.errMsg=""},2e3),console.log(a)})}else n.a.$emit(s.a.showToast,"短信验证码不能为空");else n.a.$emit(s.a.showToast,"手机号不能为空")}else n.a.$emit(s.a.showToast,"银行卡号不能为空");else n.a.$emit(s.a.showToast,"请选择银行")},pollHandle:function(){var t=this,a=0;l=setInterval(function(){if(a++,console.log(a),6==a)return t.Londing.close(),void clearInterval(l);t.Londing.open(),t.checkID()},5e3)},getBankList:function(){var t=this;o.a.common.apiGetBankCardList({},function(a){var e={};a.BAND_CARD_LIST.forEach(function(t){e[t.BANK_CARD_BIN]=t.BANK_NAME}),t.AllBankListObj=e,t.bankList=a.SUPPORT_BANK_LIST.map(function(t){return{name:t.BANK_NAME,value:0,src:s.g+t.BANK_LOGO_URL,Index:t.INITIAL}})})}}},r=e("b1t1"),d={data:function(){return{data:{CARD_NO:"",HAS_BAND:"0",PHONE_NUM:"",PRE_PHONE_NUM:"",PHONE_CODE:"",LAST_STEP_NUM:"",MESSAGE_TOKEN:"",REQ_SERIAL:""},tel:"",canClick:!0,codeText:"获取验证码",disable:!1,bankList:[],bank:"-1",bankText:"请选择开户银行",stepImg:e("T201"),stepImg2:e("r2sr"),stepImg3:e("yIMT"),AllBankListObj:{},errMsg:"",checkBankName1:!1,callbackInfos:{}}},mixins:[_],components:{BankSelect:i.a,PassWordZhengzhou:r.a},watch:{tel:function(t,a){t.length>11&&(console.log(t),this.tel=t.toString().substr(0,11))},bankText:function(t,a){this.checkBankName(this.data.CARD_NO)}},filters:{telFlter:function(t){if(t.length>11)return t.toString().substr(0,11)}},created:function(){this.checkBankStatus(function(){}),this.callbackInfos=this.getComState.openingData,console.log("callbackInfos>>>",this.callbackInfos),this.tel=this.callbackInfos.PHONE_NUM||"",this.getBankList()},methods:{checkBankName:function(t){this.checkBankName1=!1,this.checkBankType(),t=t.replace(/\s+/g,"");for(var a=void 0,e=3;e<8;e++)if(a=this.machBankName((t+"").slice(0,e))){this.bankText=a,console.log("bankName",a);break}},checkBankNo:function(t){return""==(t=t.toString())?(n.a.$emit(s.a.showToast,"银行卡号不能为空"),!0):(t.length<15||t.length>19)&&(n.a.$emit(s.a.showToast,"银行卡号格式不正确"),!0)},machBankName:function(t){return this.AllBankListObj[t]},getBank:function(t){console.log(t),this.bankText=t.name},goNext:function(){this.doOpengingSecond()}}},h={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"warp"},[e("app-bar",{attrs:{title:"信息填写"}}),t._v(" "),e("section",{staticClass:"wrapicon"},[e("section",{staticClass:"circle"},[e("span",{staticClass:"line1"},[e("img",{attrs:{src:t.stepImg,alt:""}})]),t._v(" "),e("p",{staticClass:"step-text"},[t._v("开户信息验证")])]),t._v(" "),e("section",{staticClass:"circle"},[e("span",{staticClass:"line2"},[e("img",{attrs:{src:t.stepImg,alt:""}})]),t._v(" "),e("p",{staticClass:"step-text"},[t._v("绑定银行卡")])]),t._v(" "),e("section",{staticClass:"circle"},[e("span",{staticClass:"line3 hui"},[e("img",{attrs:{src:t.stepImg3,alt:""}})]),t._v(" "),e("p",{staticClass:"step-text",staticStyle:{color:"#D3D3D3"}},[t._v("设置密码")])])]),t._v(" "),e("div",{staticClass:"opening_box"},[e("section",{staticClass:"bank"},[e("span",{staticClass:"left-p",staticStyle:{"padding-right":"0px"}},[t._v("选择银行")]),t._v(" "),e("Bank-select",{staticClass:"bank-box",attrs:{text:t.bankText,options:t.bankList,title:"银行列表",xiane:"false"},on:{getValue:t.getBank}})],1),t._v(" "),e("section",{staticClass:"input-box"},[e("p",{staticClass:"left-p"},[t._v(" 绑定卡卡号")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.CARD_NO,expression:"data.CARD_NO"}],attrs:{type:"number",name:"backname",placeholder:"请输入储蓄卡卡号"},domProps:{value:t.data.CARD_NO},on:{blur:function(a){t.checkBankName(t.data.CARD_NO)},input:function(a){a.target.composing||t.$set(t.data,"CARD_NO",a.target.value)}}})]),t._v(" "),e("section",{staticClass:"input-box"},[e("p",{staticClass:"left-p"},[t._v("手机号码")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.tel,expression:"tel"}],attrs:{disabled:t.telDisabled,type:"text",name:"tel",placeholder:"银行预留手机号"},domProps:{value:t.tel},on:{input:function(a){a.target.composing||(t.tel=a.target.value)}}})]),t._v(" "),e("section",{staticClass:"input-box"},[e("p",{staticClass:"left-p"},[t._v("验证码")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.PHONE_CODE,expression:"data.PHONE_CODE"}],attrs:{type:"text",placeholder:"验证码"},domProps:{value:t.data.PHONE_CODE},on:{input:function(a){a.target.composing||t.$set(t.data,"PHONE_CODE",a.target.value)}}}),t._v(" "),e("button",{staticClass:"msg-code",attrs:{disabled:t.disable},on:{click:t.clickMsgCodeHandle}},[t._v(t._s(t.codeText))])])]),t._v(" "),t.errMsg?e("div",{staticClass:"msg-err"},[e("span",[t._v(t._s(t.errMsg))])]):t._e(),t._v(" "),e("button",{staticClass:"tijiao",on:{click:t.goNext}},[t._v("下一步")]),t._v(" "),t.ZhengZhouPass?e("div",{staticClass:"bgbox"},[e("div",{staticClass:"passbox"},[e("div",{staticClass:"top"},[e("div",{staticClass:"field_row_wrap"},[e("p",{staticClass:"field_row_key"},[t._v("\n            请输入郑州银行（"+t._s(t._f("CARD_NO_Fliter")(t.data.CARD_NO))+"）的密码\n          ")]),t._v(" "),e("div",{staticClass:"field_row_value"},[e("pass-word-zhengzhou",{attrs:{BankCardPass:"bank-passCCCC"}})],1),t._v(" "),e("p",{staticClass:"info"},[t._v("密码为6位数字")])])]),t._v(" "),e("div",{staticClass:"btn"},[e("button",{on:{click:t.cancel}},[t._v("取消")]),t._v(" "),e("button",{on:{click:t.subumit}},[t._v("提交")])])])]):t._e()],1)},staticRenderFns:[]};var C=e("VU/8")(d,h,!1,function(t){e("2FyH")},"data-v-2e1384c4",null);a.default=C.exports}});
//# sourceMappingURL=97.ac66362b3e81a4275c21.js.map