webpackJsonp([114],{"2kt1":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("MmTA"),i=a("xEK7"),n=a("b1t1"),o=a("EOwk"),l=a("0jG4"),c=a("JIj5"),r=o.c+"/finsuitSafeCode?SESSION_ID=",d={data:function(){return{safeCode:"",safeCodeUrl:r,SESSION_ID:"",showSafeCode:!1,data:{CARD_NO:"",HAS_BAND:"0",PHONE_NUM:"",PRE_PHONE_NUM:"",PHONE_CODE:"",LAST_STEP_NUM:"",MESSAGE_TOKEN:"",REQ_SERIAL:""},tel:"",canClick:!0,codeText:"获取验证码",disable:!1,bankList:[],bank:"-1",bankText:"请选择开户银行",stepImg:a("T201"),stepImg2:a("r2sr"),stepImg3:a("yIMT"),AllBankListObj:{},errMsg:"",checkBankName1:!1,telDisabled:!1}},components:{BankSelect:i.a,PassWordZhengzhou:n.a},watch:{tel:function(t,e){t.length>11&&(console.log(t),this.tel=t.toString().substr(0,11))},bankText:function(t,e){}},computed:{cantNext:function(){return!(this.tel.length>0&&this.data.PHONE_CODE.length>0&&this.data.CARD_NO.length>0)}},filters:{telFlter:function(t){if(t.length>11)return t.toString().substr(0,11)},CARD_NO_Fliter:function(t){return t?t.substr(t.length-4):t}},created:function(){this.data.REQ_SERIAL=this.$route.query.REQ_SERIAL,this.data.LAST_STEP_NUM=this.$route.query.LAST_STEP_NUM,this.getBankList()},methods:{timeDown:function(){var t=this,e=60;this.disable=!0;var a=setInterval(function(){if(0==e)return t.codeText="重新发送",t.disable=!1,void clearInterval(a);e--,t.codeText=e+"s"},1e3)},clickMsgCodeHandle:function(){var t=this.tel;t+="",console.log(t),c.a.Check.tel(t,!0)||(this.SESSION_ID=this.$store.getters.GET_ACCOUNT_STATE.SESSION_ID+Math.random(),this.showSafeCode=!0)},getMsgCode:function(){var t=this,e={PHONE_NUM:this.tel,SAFT_CODE:this.safeCode,BANK_CARD:this.data.CARD_NO};this.$store.commit("SET_SESSION_ID",this.SESSION_ID),this.safeCode="",l.a.bicai.sendSMSCodeToBindCard(e,function(e){0==e.STATUS&&t.timeDown(),s.a.$emit(o.a.showToast,e.MESSAGE),t.showSafeCode=!1},function(e){t.SESSION_ID="",t.codeText="重新发送",t.disable=!1,t.showSafeCode=!1,console.log(e)})},pollHandle:function(){var t=this,e=0,a=setInterval(function(){if(e++,console.log(e),6==e)return t.Londing.close(),void clearInterval(a);t.Londing.open(),t.checkID()},5e3)},checkID:function(){var t=this;l.a.bicai.getMerberAuthStatusInfo({},function(e){var a=e.status;console.log(a),3!=a&&4!=a||(clearInterval(timer),t.$router.push({name:o.e.BcOpening3}))})},getBankNameByCardNo:function(){var t=this,e={cardNo:this.data.CARD_NO};l.a.bicai.getCardBinList(e,function(e){e.length>0&&(t.bankText=e[0].ISSUER_NAME)})},getBankList:function(){var t=this;l.a.bicai.getBingingCardsList({},function(e){var a={};e.bankList.forEach(function(t){a[t.BANK_CARD_BIN]=t.BANK_NAME}),t.AllBankListObj=a,t.bankList=e.bankList.map(function(t){return{name:t.ORG_NAME,value:0,src:o.g+t.LOGO_URL,Index:t.ORG_NAME_FIRST_LETTER}})})},getSafeCode:function(){this.safeCode?this.getMsgCode():s.a.$emit(o.a.showToast,"图形验证码不能为空")},checkBankName:function(t){this.getBankNameByCardNo()},machBankName:function(t){return this.AllBankListObj[t]},checkBankNo:function(t){t=t.toString();return console.log(!/\d{15}|\d{19}/.test(t)),""==t?(s.a.$emit(o.a.showToast,"银行卡号不能为空"),!0):(t.length<15||t.length>19)&&(s.a.$emit(o.a.showToast,"银行卡号格式不正确"),!0)},getBank:function(t){console.log(t),this.bankText=t.name},goNext:function(){var t=this;if(this.data.PRE_PHONE_NUM=this.tel,console.log(this.data.PRE_PHONE_NUM),"请选择银行"!=this.bankText)if(""!=this.data.CARD_NO){if(!this.checkBankNo(this.data.CARD_NO))if(""!=this.data.PRE_PHONE_NUM)if(""!=this.data.PHONE_CODE){var e={bankCardNo:this.data.CARD_NO,mobile:this.tel,smsCode:this.data.PHONE_CODE};l.a.bicai.bindCardFourELement(e,function(e){t.Londing.close(),setTimeout(function(){t.errMsg=""},2e3);var a=e.status;console.log("status>>>",a),0==a?t.$router.push({name:o.e.BcOpening3}):t.pollHandle(),l.a.watchApi({FUNCTION_ID:"ptb0A004",REMARK_DATA:"异业合作-开户-绑定银行卡"})},function(e){l.a.watchApi({FUNCTION_ID:"ptb0A004",REMARK_DATA:"异业合作-开户-绑定银行卡"}),t.pollHandle(),t.errMsg=e,setTimeout(function(){t.errMsg=""},2e3),console.log(e),t.disable=!1})}else s.a.$emit(o.a.showToast,"短信验证码不能为空");else s.a.$emit(o.a.showToast,"手机号不能为空")}else s.a.$emit(o.a.showToast,"银行卡号不能为空");else s.a.$emit(o.a.showToast,"请选择银行")}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"warp"},[a("app-bar",{attrs:{title:"信息填写"}}),t._v(" "),a("section",{staticClass:"wrapicon"},[a("section",{staticClass:"circle"},[a("span",{staticClass:"line1"},[a("img",{attrs:{src:t.stepImg,alt:""}})]),t._v(" "),a("p",{staticClass:"step-text"},[t._v("开户信息验证")])]),t._v(" "),a("section",{staticClass:"circle"},[a("span",{staticClass:"line2"},[a("img",{attrs:{src:t.stepImg,alt:""}})]),t._v(" "),a("p",{staticClass:"step-text"},[t._v("绑定银行卡")])]),t._v(" "),a("section",{staticClass:"circle"},[a("span",{staticClass:"line3 hui"},[a("img",{attrs:{src:t.stepImg3,alt:""}})]),t._v(" "),a("p",{staticClass:"step-text"},[t._v("设置密码")])])]),t._v(" "),a("div",{staticClass:"opening_box"},[a("section",{staticClass:"input-box"},[a("p",{staticClass:"left-p"},[t._v(" 绑定卡卡号")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.CARD_NO,expression:"data.CARD_NO"}],attrs:{type:"number",name:"backname",placeholder:"请输入储蓄卡卡号"},domProps:{value:t.data.CARD_NO},on:{blur:function(e){t.checkBankName(t.data.CARD_NO)},input:function(e){e.target.composing||t.$set(t.data,"CARD_NO",e.target.value)}}})]),t._v(" "),a("section",{staticClass:"bank"},[a("span",{staticClass:"left-p",staticStyle:{"padding-right":"0px"}},[t._v("选择银行")]),t._v(" "),a("Bank-select",{staticClass:"bank-box",attrs:{text:t.bankText,options:t.bankList,title:"银行列表"},on:{getValue:t.getBank}})],1),t._v(" "),a("section",{staticClass:"input-box"},[a("p",{staticClass:"left-p"},[t._v("手机号码")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tel,expression:"tel"}],attrs:{disabled:t.telDisabled,type:"text",name:"tel",placeholder:"银行预留手机号"},domProps:{value:t.tel},on:{input:function(e){e.target.composing||(t.tel=e.target.value)}}})]),t._v(" "),a("section",{staticClass:"input-box"},[a("p",{staticClass:"left-p"},[t._v("验证码")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.PHONE_CODE,expression:"data.PHONE_CODE"}],attrs:{type:"text",placeholder:"验证码"},domProps:{value:t.data.PHONE_CODE},on:{input:function(e){e.target.composing||t.$set(t.data,"PHONE_CODE",e.target.value)}}}),t._v(" "),a("button",{staticClass:"msg-code",attrs:{disabled:t.disable},on:{click:t.clickMsgCodeHandle}},[t._v(t._s(t.codeText))])])]),t._v(" "),t.errMsg?a("div",{staticClass:"msg-err"},[a("span",[t._v(t._s(t.errMsg))])]):t._e(),t._v(" "),a("button",{staticClass:"tijiao",class:{cantNext:t.cantNext},attrs:{disabled:t.cantNext},on:{click:t.goNext}},[t._v("下一步")]),t._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:t.showSafeCode,expression:"showSafeCode"}],staticClass:"safe-code"},[a("div",[a("p",[t._v("请填写图形验证码")]),t._v(" "),a("section",{staticClass:"middle"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.safeCode,expression:"safeCode"}],attrs:{type:"tel",placeholder:"请输入图形验证码"},domProps:{value:t.safeCode},on:{input:function(e){e.target.composing||(t.safeCode=e.target.value)}}}),t._v(" "),a("img",{attrs:{src:t.safeCodeUrl+t.SESSION_ID,alt:""}})]),t._v(" "),a("section",{staticClass:"btn"},[a("button",{on:{click:function(e){t.showSafeCode=!1}}},[t._v("取消")]),t._v(" "),a("button",{on:{click:t.getSafeCode}},[t._v("确定")])])])])],1)},staticRenderFns:[]};var _=a("VU/8")(d,u,!1,function(t){a("AlDL")},"data-v-12b02426",null);e.default=_.exports},AlDL:function(t,e){}});
//# sourceMappingURL=114.18ab9204484f86601111.js.map